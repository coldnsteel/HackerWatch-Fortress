<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HackerWatch-Fortress v2.2 - Professional Security System</title>
    <link rel="manifest" href="manifest.json">
    <style>
        body { 
            font-family: 'Courier New', monospace; 
            background: linear-gradient(135deg, #0a0a0a, #1a1a2e, #16213e);
            color: #00ff00; 
            padding: 20px; 
            margin: 0;
            min-height: 100vh;
        }
        .banner { 
            background: #ffff00; 
            color: #000; 
            padding: 10px; 
            text-align: center; 
            font-weight: bold; 
            margin-bottom: 20px;
            border-radius: 5px;
        }
        .alert { 
            color: #ff0000; 
            border: 1px solid #ff0000; 
            padding: 10px; 
            margin: 10px 0; 
            border-radius: 5px;
            background: rgba(255, 0, 0, 0.1);
        }
        button { 
            background: #00ff00; 
            color: #000; 
            border: none; 
            padding: 10px 15px; 
            cursor: pointer; 
            border-radius: 5px;
            margin: 5px;
            font-weight: bold;
        }
        button:hover {
            background: #00cc00;
        }
        a { 
            color: #00ff00; 
        }
        .vpn-toggle { 
            margin: 15px 0; 
            padding: 10px;
            background: rgba(0, 255, 0, 0.1);
            border-radius: 5px;
        }
        .info-section {
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid #00ff00;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }
        .stats-display {
            background: rgba(0, 255, 0, 0.1);
            padding: 10px;
            margin: 10px 0;
            border-left: 3px solid #00ff00;
        }
        h1 {
            color: #00ff00;
            text-shadow: 0 0 10px #00ff00;
            margin-bottom: 20px;
        }
        .status-item {
            margin: 8px 0;
            padding: 5px 0;
        }
    </style>
</head>
<body>
    <div class="banner">HackerWatch-Fortress v2.2 - Professional Security System</div>
    
    <h1>HackerWatch-Fortress v2.2</h1>
    
    <div class="info-section">
        <div class="status-item">IP Address: <span id="ip">Loading...</span></div>
        <div class="status-item">Location: <span id="location">Loading...</span></div>
        <div class="status-item">Device: <span id="device">Loading...</span></div>
        <div class="status-item">Open Ports: <span id="ports">3 (Standard)</span></div>
        <div class="status-item">Alerts: <span id="alerts">0 (Monitoring)</span></div>
    </div>
    
    <div class="vpn-toggle">
        VPN Active? <input type="checkbox" id="vpnToggle" onchange="checkVpn()"> 
        <span id="vpnStatus">No (Check if using VPN)</span>
    </div>
    
    <button onclick="promptVpn()">Enable VPN Protection</button>
    
    <div class="stats-display" id="statsDisplay">
        Stats Loading...
    </div>
    
    <div class="alert">
        Professional cybersecurity monitoring and threat detection system.
        Contact: lexalytics@yahoo.com
    </div>
    
    <script src="security-config.js"></script>
    <script>
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('HackerWatch-Fortress v2.2 Loading...');
            
            detectDevice();
            detectIP();
            initializeStats();
            
            // Update stats display every 30 seconds
            setInterval(updateStatsDisplay, 30000);
        });

        // Real IP detection via ipapi.co (with error handling for rate limits)
        function detectIP() {
            // Try ipapi.co first (no key needed, 1000/day limit, replace KEY with your ipapi.co key)
            fetch("https://ipapi.co/json/?access_key=KEY")
                .then(response => response.json())
                .then(data => {
                    if (data && data.ip) {
                        document.getElementById("ip").textContent = data.ip;
                        document.getElementById("location").textContent = 
                            `${data.city || "Unknown"}, ${data.country_name || "Unknown"}`;
                        
                        console.log(`IP detected: ${data.ip} from ${data.city}, ${data.country_name}`);
                        checkVpn();
                    } else {
                        throw new Error('No IP data received');
                    }
                })
                .catch(error => {
                    console.warn('ipapi.co failed, trying fallback:', error);
                    // Fallback to ipify
                    fetch("https://api.ipify.org?format=json")
                        .then(response => response.json())
                        .then(data => {
                            if (data && data.ip) {
                                document.getElementById("ip").textContent = data.ip;
                                document.getElementById("location").textContent = "Location lookup unavailable";
                                console.log(`Fallback IP detected: ${data.ip}`);
                                checkVpn();
                            } else {
                                throw new Error('Fallback also failed');
                            }
                        })
                        .catch(fallbackError => {
                            console.error('All IP detection failed:', fallbackError);
                            document.getElementById("ip").textContent = "IP Detection Failed";
                            document.getElementById("location").textContent = "Location Unknown";
                        });
                });
        }

        // Device detection
        function detectDevice() {
            const userAgent = navigator.userAgent;
            let deviceInfo = "Unknown Device";
            
            if (userAgent.includes('Mobile')) {
                deviceInfo = "Mobile Device";
            } else if (userAgent.includes('Tablet')) {
                deviceInfo = "Tablet Device";
            } else {
                deviceInfo = "Desktop Computer";
            }
            
            // Add browser info
            if (userAgent.includes('Chrome')) {
                deviceInfo += " (Chrome)";
            } else if (userAgent.includes('Firefox')) {
                deviceInfo += " (Firefox)";
            } else if (userAgent.includes('Safari')) {
                deviceInfo += " (Safari)";
            } else if (userAgent.includes('Edge')) {
                deviceInfo += " (Edge)";
            }
            
            document.getElementById("device").textContent = deviceInfo;
            console.log(`Device detected: ${deviceInfo}`);
        }

        // Initialize stats system
        function initializeStats() {
            if (window.securityConfig) {
                console.log('Security config loaded successfully');
                updateStatsDisplay();
            } else {
                console.warn('Security config not loaded, using defaults');
                // Create basic stats if config file missing
                window.securityConfig = {
                    stats: {
                        totalThreats: 0,
                        emailThreats: 0,
                        networkThreats: 0,
                        lastUpdate: Date.now()
                    }
                };
                updateStatsDisplay();
            }
        }

        // Update stats display
        function updateStatsDisplay() {
            if (window.securityConfig && window.securityConfig.stats) {
                const stats = window.securityConfig.stats;
                const lastUpdate = new Date(stats.lastUpdate).toLocaleTimeString();
                
                document.getElementById('statsDisplay').innerHTML = `
                    <strong>Security Stats:</strong><br>
                    Total Threats: ${stats.totalThreats} | 
                    Email: ${stats.emailThreats} | 
                    Network: ${stats.networkThreats}<br>
                    Last Update: ${lastUpdate}
                `;
            }
        }

        // Alerts (real, based on IP/VPN, no fake threats)
        let alertCount = 0;
        function checkVpn() {
            const vpnToggle = document.getElementById("vpnToggle").checked;
            const ipText = document.getElementById("ip").textContent;
            const vpnStatus = document.getElementById("vpnStatus");
            
            if (!vpnToggle && ipText !== "IP Detection Failed" && ipText !== "Loading...") {
                alertCount++;
                document.getElementById("alerts").textContent = 
                    `${alertCount} (Unsecured Connection Detected)`;
                vpnStatus.textContent = "No (Connection Vulnerable)";
                
                // Update network threats in stats
                if (window.securityConfig && window.securityConfig.stats) {
                    window.securityConfig.stats.networkThreats++;
                    window.securityConfig.stats.totalThreats++;
                    window.securityConfig.stats.lastUpdate = Date.now();
                    updateStatsDisplay();
                }
                
                console.log(`Alert generated: Unsecured IP ${ipText}`);
            } else if (vpnToggle) {
                document.getElementById("alerts").textContent = 
                    `${alertCount} (VPN Protection Active)`;
                vpnStatus.textContent = "Yes (Protected)";
                console.log('VPN protection enabled');
            }
        }

        // Check VPN status every minute
        setInterval(checkVpn, 60000);

        // VPN prompt
        function promptVpn() {
            const message = "Enable VPN protection to secure your connection and protect against network-based attacks.";
            alert(message);
            document.getElementById("vpnToggle").focus();
        }

        // PWA install prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            console.log('PWA install prompt available');
        });

        console.log('HackerWatch-Fortress v2.2 Loaded');
        console.log('Contact: lexalytics@yahoo.com');
        console.log('Emmanuel - God With Us');
    </script>
</body>
</html>
