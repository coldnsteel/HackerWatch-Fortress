<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HackerWatch-Fortress v2.2 - Professional Security System</title>
    <link rel="manifest" href="manifest.json">
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #0a0a0a;
            color: #00ff00;
            padding: 20px;
            margin: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .banner {
            background: #ff0000;
            color: #000;
            padding: 15px;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            width: 100%;
            max-width: 600px;
            border-radius: 8px;
            box-shadow: 0 0 15px #ff0000;
            margin-bottom: 20px;
        }
        .alert {
            color: #ff0000;
            border: 2px solid #ff0000;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            background: rgba(255, 0, 0, 0.2);
            max-width: 600px;
            text-align: center;
            font-weight: bold;
        }
        button {
            background: #00ff00;
            color: #000;
            border: none;
            padding: 12px 20px;
            cursor: pointer;
            border-radius: 8px;
            margin: 10px;
            font-size: 1.1em;
            font-weight: bold;
            box-shadow: 0 0 10px #00ff00;
        }
        button:hover {
            background: #00cc00;
            box-shadow: 0 0 15px #00cc00;
        }
        a {
            color: #00ff00;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        .vpn-toggle {
            margin: 20px 0;
            padding: 15px;
            background: rgba(0, 255, 0, 0.2);
            border-radius: 8px;
            max-width: 600px;
            text-align: center;
            font-size: 1.1em;
        }
        .info-section {
            background: rgba(0, 0, 0, 0.8);
            border: 2px solid #00ff00;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            max-width: 600px;
            box-shadow: 0 0 15px #00ff00;
        }
        .stats-display {
            background: rgba(0, 255, 0, 0.2);
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #00ff00;
            border-radius: 8px;
            max-width: 600px;
            font-size: 1.1em;
        }
        h1 {
            color: #00ff00;
            text-shadow: 0 0 15px #00ff00;
            margin-bottom: 20px;
            font-size: 2em;
            text-align: center;
        }
        .status-item {
            margin: 10px 0;
            padding: 8px 0;
            font-size: 1.1em;
        }
    </style>
</head>
<body>
    <div class="banner">HackerWatch-Fortress v2.2 - Professional Security System</div>
    
    <h1>HackerWatch-Fortress v2.2</h1>
    
    <div class="info-section">
        <div class="status-item">IP Address: <span id="ip">Loading...</span></div>
        <div class="status-item">Location: <span id="location">Loading...</span></div>
        <div class="status-item">Device: <span id="device">Loading...</span></div>
        <div class="status-item">Open Ports: <span id="ports">3 (Standard)</span></div>
        <div class="status-item">Alerts: <span id="alerts">0 (Monitoring)</span></div>
    </div>
    
    <div class="vpn-toggle">
        VPN Active? <input type="checkbox" id="vpnToggle" onchange="checkVpn()"> 
        <span id="vpnStatus">No (Check if using VPN)</span>
    </div>
    
    <button onclick="promptVpn()">Enable VPN Protection</button>
    
    <div class="stats-display" id="statsDisplay">
        Stats Loading...
    </div>
    
    <div class="alert">
        Monitors your IP and device for security risks. An exposed IP can reveal your location to attackers, risking tracking or data breaches. Enable a VPN to hide your IP and secure your connection. 
        Contact: <a href="mailto:lexalytics@yahoo.com">lexalytics@yahoo.com</a>
    </div>
    
    <script src="security-config.js"></script>
    <script>
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            console.log('HackerWatch-Fortress v2.2 Loading...');
            
            detectDevice();
            detectIP();
            initializeStats();
            
            // Update stats display every 30 seconds
            setInterval(updateStatsDisplay, 30000);
        });

        // Real IP detection via ipapi.co (with error handling for rate limits)
        function detectIP() {
            // Try ipapi.co first (no key needed, 1000/day limit, replace KEY with your ipapi.co key)
            fetch("https://ipapi.co/json/?access_key=KEY")
                .then(response => response.json())
                .then(data => {
                    if (data && data.ip) {
                        document.getElementById("ip").textContent = data.ip;
                        document.getElementById("location").textContent = 
                            `${data.city || "Unknown"}, ${data.country_name || "Unknown"}`;
                        
                        console.log(`IP detected: ${data.ip} from ${data.city}, ${data.country_name}`);
                        checkVpn();
                    } else {
                        throw new Error('No IP data received');
                    }
                })
                .catch(error => {
                    console.warn('ipapi.co failed, trying fallback:', error);
                    // Fallback to ipify
                    fetch("https://api.ipify.org?format=json")
                        .then(response => response.json())
                        .then(data => {
                            if (data && data.ip) {
                                document.getElementById("ip").textContent = data.ip;
                                document.getElementById("location").textContent = "Location lookup unavailable";
                                console.log(`Fallback IP detected: ${data.ip}`);
                                checkVpn();
                            } else {
                                throw new Error('Fallback also failed');
                            }
                        })
                        .catch(fallbackError => {
                            console.error('All IP detection failed:', fallbackError);
                            document.getElementById("ip").textContent = "IP Detection Failed";
                            document.getElementById("location").textContent = "Location Unknown";
                        });
                });
        }

        // Device detection
        function detectDevice() {
            const userAgent = navigator.userAgent;
            let deviceInfo = "Unknown Device";
            
            if (userAgent.includes('Mobile')) {
                deviceInfo = "Mobile Device";
            } else if (userAgent.includes('Tablet')) {
                deviceInfo = "Tablet Device";
            } else {
                deviceInfo = "Desktop Computer";
            }
            
            // Add browser info
            if (userAgent.includes('Chrome')) {
                deviceInfo += " (Chrome)";
            } else if (userAgent.includes('Firefox')) {
                deviceInfo += " (Firefox)";
            } else if (userAgent.includes('Safari')) {
                deviceInfo += " (Safari)";
            } else if (userAgent.includes('Edge')) {
                deviceInfo += " (Edge)";
            }
            
            document.getElementById("device").textContent = deviceInfo;
            console.log(`Device detected: ${deviceInfo}`);
        }

        // Initialize stats system
        function initializeStats() {
            if (window.securityConfig) {
                console.log('Security config loaded successfully');
                updateStatsDisplay();
            } else {
                console.warn('Security config not loaded, using defaults');
                // Create basic stats if config file missing
                window.securityConfig = {
                    stats: {
                        totalThreats: 0,
                        emailThreats: 0,
                        networkThreats: 0,
                        lastUpdate: Date.now()
                    }
                };
                updateStatsDisplay();
            }
        }

        // Update stats display
        function updateStatsDisplay() {
            if (window.securityConfig && window.securityConfig.stats) {
                const stats = window.securityConfig.stats;
                const lastUpdate = new Date(stats.lastUpdate).toLocaleTimeString();
                
                document.getElementById('statsDisplay').innerHTML = `
                    <strong>Security Stats:</strong><br>
                    Total Threats: ${stats.totalThreats} | 
                    Email: ${stats.emailThreats} | 
                    Network: ${stats.networkThreats}<br>
                    Last Update: ${lastUpdate}
                `;
            }
        }

        // Alerts (real, based on IP/VPN, no fake threats)
        let alertCount = 0;
        function checkVpn() {
            const vpnToggle = document.getElementById("vpnToggle").checked;
            const ipText = document.getElementById("ip").textContent;
            const vpnStatus = document.getElementById("vpnStatus");
            
            if (!vpnToggle && ipText !== "IP Detection Failed" && ipText !== "Loading...") {
                alertCount++;
                document.getElementById("alerts").textContent = 
                    `${alertCount} (Unsecured IP - Exposed to Attackers)`;
                vpnStatus.textContent = "No (Vulnerable)";
                vpnStatus.style.color = "#ff0000";
                
                // Update network threats in stats
                if (window.securityConfig && window.securityConfig.stats) {
                    window.securityConfig.stats.networkThreats++;
                    window.securityConfig.stats.totalThreats++;
                    window.securityConfig.stats.lastUpdate = Date.now();
                    updateStatsDisplay();
                }
                
                console.log(`Alert generated: Unsecured IP ${ipText}`);
            } else if (vpnToggle) {
                document.getElementById("alerts").textContent = 
                    `${alertCount} (VPN Active - IP Protected)`;
                vpnStatus.textContent = "Yes (Secured)";
                vpnStatus.style.color = "#00ff00";
                console.log('VPN protection enabled');
            }
        }

        // Check VPN status every minute
        setInterval(checkVpn, 60000);

        // VPN prompt
        function promptVpn() {
            const message = "Without a VPN, your IP is exposed, risking tracking or data breaches. Enable a VPN (e.g., NordVPN, ProtonVPN) to hide your IP and secure your connection.";
            alert(message);
            document.getElementById("vpnToggle").focus();
        }

        // PWA install prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            console.log('PWA install prompt available');
        });

        console.log('HackerWatch-Fortress v2.2 Loaded');
        console.log('Contact: lexalytics@yahoo.com');
        console.log('Emmanuel - God With Us');
    </script>
</body>
</html>
