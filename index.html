<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HackerWatch-Fortress: Professional Security System</title>
    <link rel="manifest" href="manifest.json">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #0a0a0a, #1a1a2e, #16213e);
            color: #00ff00;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .header {
            background: rgba(0, 0, 0, 0.9);
            border-bottom: 2px solid #00ff00;
            padding: 10px 20px;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            color: #00ff00;
            text-shadow: 0 0 10px #00ff00;
            font-size: 24px;
        }
        
        .status-bar {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 12px;
        }
        
        .main-container {
            margin-top: 100px;
            padding: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            min-height: calc(100vh - 120px);
        }
        
        .panel {
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid #00ff00;
            border-radius: 10px;
            padding: 15px;
            backdrop-filter: blur(5px);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
        }
        
        .panel h3 {
            color: #ffffff;
            margin-bottom: 15px;
            border-bottom: 1px solid #00ff00;
            padding-bottom: 5px;
        }
        
        .threat-level {
            font-size: 48px;
            text-align: center;
            margin: 20px 0;
            text-shadow: 0 0 20px currentColor;
        }
        
        .level-low { color: #00ff00; }
        .level-medium { color: #ffff00; }
        .level-high { color: #ff6600; }
        .level-critical { color: #ff0000; }
        
        .metrics {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 8px;
            background: rgba(0, 255, 0, 0.1);
            border-radius: 5px;
        }
        
        .log-entry {
            margin: 5px 0;
            padding: 5px;
            background: rgba(0, 0, 0, 0.5);
            border-left: 3px solid #00ff00;
            font-size: 11px;
            border-radius: 3px;
        }
        
        .log-warning { border-left-color: #ffff00; }
        .log-error { border-left-color: #ff0000; }
        .log-info { border-left-color: #00aaff; }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff00, #00aa00);
            transition: width 0.3s ease;
            box-shadow: 0 0 10px #00ff00;
        }
        
        .scan-button {
            background: linear-gradient(45deg, #00ff00, #00aa00);
            color: #000;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            width: 100%;
            margin: 10px 0;
            transition: all 0.3s ease;
        }
        
        .scan-button:hover {
            box-shadow: 0 0 20px #00ff00;
            transform: translateY(-2px);
        }
        
        .scan-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        
        .network-map {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
            margin: 15px 0;
        }
        
        .network-node {
            width: 40px;
            height: 40px;
            border: 2px solid #00ff00;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            transition: all 0.3s ease;
            animation: securePulse 3s infinite;
        }
        
        .node-secure {
            background: rgba(0, 255, 0, 0.3);
        }
        
        .node-warning { 
            background: rgba(255, 255, 0, 0.3); 
            border-color: #ffff00;
            animation: warningBlink 1s infinite;
        }
        
        .node-threat { 
            background: rgba(255, 0, 0, 0.3); 
            border-color: #ff0000;
            animation: threatAlert 0.5s infinite;
        }
        
        @keyframes securePulse {
            0%, 100% { 
                transform: scale(1); 
                box-shadow: 0 0 5px #00ff00;
            }
            50% { 
                transform: scale(1.05); 
                box-shadow: 0 0 15px #00ff00;
            }
        }
        
        @keyframes warningBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
        
        @keyframes threatAlert {
            0%, 100% { 
                background: rgba(255, 0, 0, 0.3);
                transform: scale(1);
            }
            50% { 
                background: rgba(255, 0, 0, 0.8);
                transform: scale(1.1);
            }
        }
        
        .terminal {
            background: #000;
            color: #00ff00;
            padding: 10px;
            border-radius: 5px;
            height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 10px;
        }
        
        .blinking-cursor::after {
            content: '_';
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .alert-banner {
            position: fixed;
            top: 80px;
            right: 20px;
            background: rgba(255, 0, 0, 0.9);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            display: none;
            z-index: 1001;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        .auth-panel {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #00ff00;
        }
        
        .auth-box {
            background: #1a1a2e;
            padding: 30px;
            border: 2px solid #00ff00;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.5);
        }
        
        .auth-input {
            background: #000;
            color: #00ff00;
            border: 1px solid #00ff00;
            padding: 10px;
            margin: 10px;
            width: 250px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
        }
        
        .auth-button {
            background: #00ff00;
            color: #000;
            border: none;
            padding: 10px 20px;
            margin: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-family: 'Courier New', monospace;
        }
        
        @media (max-width: 768px) {
            .main-container {
                grid-template-columns: 1fr;
                margin-top: 120px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üõ°Ô∏è HackerWatch-Fortress: Professional Security System</h1>
        <div class="status-bar">
            <span>Status: <span id="systemStatus">INITIALIZING</span></span>
            <span>Last Scan: <span id="lastScan">Never</span></span>
            <span>Threats Blocked: <span id="threatsBlocked">0</span></span>
            <span>Contact: lexalytics@yahoo.com</span>
        </div>
    </div>

    <div class="alert-banner" id="alertBanner">
        <strong>SECURITY ALERT:</strong> <span id="alertMessage"></span>
    </div>

    <div class="auth-panel" id="authPanel">
        <div class="auth-box">
            <h2>üîê HackerWatch-Fortress Access Control</h2>
            <p>Enter your security credentials:</p>
            <input type="email" id="userEmail" class="auth-input" placeholder="Email Address" value="lexalytics@yahoo.com">
            <input type="password" id="userPassword" class="auth-input" placeholder="Security Key" value="fortress2025">
            <input type="text" id="mfaCode" class="auth-input" placeholder="MFA Code (6 digits)">
            <button id="authButton" class="auth-button">üõ°Ô∏è ACCESS FORTRESS</button>
            <small>Contact: lexalytics@yahoo.com for access</small>
        </div>
    </div>

    <div class="main-container">
        <!-- Threat Assessment Panel -->
        <div class="panel">
            <h3>üéØ Threat Assessment</h3>
            <div class="threat-level level-low" id="threatLevel">LOW</div>
            <div class="metrics">
                <span>Security Score:</span>
                <span id="securityScore">95%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="securityProgress" style="width: 95%"></div>
            </div>
            <button class="scan-button" id="scanButton">üîç Run Full Security Scan</button>
            <div class="metrics">
                <span>Active Protections:</span>
                <span id="activeProtections">9/9</span>
            </div>
        </div>

        <!-- Network Monitor Panel -->
        <div class="panel">
            <h3>üåê Network Monitor</h3>
            <div class="metrics">
                <span>Network Status:</span>
                <span id="networkStatus">SECURE</span>
            </div>
            <div class="network-map" id="networkMap">
                <!-- Network nodes will be generated here -->
            </div>
            <div class="metrics">
                <span>Bandwidth Usage:</span>
                <span id="bandwidthUsage">12.3 MB/s</span>
            </div>
            <div class="metrics">
                <span>Open Ports:</span>
                <span id="openPorts">3 (Secure)</span>
            </div>
            <button class="scan-button" id="networkScanButton">üì° Scan Network</button>
        </div>

        <!-- Real-time Logs Panel -->
        <div class="panel">
            <h3>üìä Security Logs</h3>
            <div class="terminal" id="securityLogs">
                <div class="log-entry">[INIT] HackerWatch-Fortress initializing...</div>
                <div class="log-entry">[INFO] Firewall status: ACTIVE</div>
                <div class="log-entry">[INFO] Intrusion detection: ENABLED</div>
                <div class="log-entry">[INFO] Email protection: ACTIVE</div>
                <div class="log-entry">[INFO] Multi-Factor Authentication: ENABLED</div>
                <div class="log-entry">[INFO] All systems operational</div>
                <div class="blinking-cursor"></div>
            </div>
        </div>

        <!-- Protection Status Panel -->
        <div class="panel">
            <h3>üõ°Ô∏è Active Protections</h3>
            <div class="metrics">
                <span>Firewall:</span>
                <span style="color: #00ff00;">ACTIVE</span>
            </div>
            <div class="metrics">
                <span>Anti-Malware:</span>
                <span style="color: #00ff00;">SCANNING</span>
            </div>
            <div class="metrics">
                <span>VPN Protection:</span>
                <span style="color: #00ff00;">ENABLED</span>
            </div>
            <div class="metrics">
                <span>DNS Filtering:</span>
                <span style="color: #00ff00;">ACTIVE</span>
            </div>
            <div class="metrics">
                <span>Port Monitoring:</span>
                <span style="color: #00ff00;">SCANNING</span>
            </div>
            <div class="metrics">
                <span>SSL/TLS Check:</span>
                <span style="color: #00ff00;">VERIFIED</span>
            </div>
            <div class="metrics">
                <span>Email Protection:</span>
                <span style="color: #00ff00;">ACTIVE</span>
            </div>
            <div class="metrics">
                <span>Intrusion Detection:</span>
                <span style="color: #00ff00;">MONITORING</span>
            </div>
            <div class="metrics">
                <span>Multi-Factor Auth:</span>
                <span style="color: #00ff00;">ENABLED</span>
            </div>
        </div>

        <!-- Device Status Panel -->
        <div class="panel">
            <h3>üì± Device Status</h3>
            <div class="metrics">
                <span>Device Type:</span>
                <span id="deviceType">Detecting...</span>
            </div>
            <div class="metrics">
                <span>OS Security:</span>
                <span id="osSecurity">Checking...</span>
            </div>
            <div class="metrics">
                <span>Browser Security:</span>
                <span id="browserSecurity">Checking...</span>
            </div>
            <div class="metrics">
                <span>Location Services:</span>
                <span id="locationStatus">Checking...</span>
            </div>
            <div class="metrics">
                <span>IP Address:</span>
                <span id="ipAddress">Checking...</span>
            </div>
            <button class="scan-button" id="deviceScanButton">üîç Check Device Security</button>
        </div>

        <!-- Incident Response Panel -->
        <div class="panel">
            <h3>‚ö° Incident Response</h3>
            <div class="terminal" id="incidentLogs">
                <div class="log-entry log-info">[MONITOR] Continuous monitoring active</div>
                <div class="log-entry log-info">[DETECT] Behavioral analysis running</div>
                <div class="log-entry log-info">[EMAIL] Anti-phishing shield active</div>
                <div class="log-entry log-info">[INTRUSION] Suspicious activity monitoring enabled</div>
                <div class="log-entry log-info">[MFA] Two-factor authentication enforced</div>
                <div class="log-entry log-info">[PROTECT] All shields operational</div>
                <div class="blinking-cursor"></div>
            </div>
            <button class="scan-button" id="lockdownButton">üö® Emergency Lockdown</button>
        </div>
    </div>

    <script src="security-config.js"></script>
    <script>
        (function() {
            'use strict';
            
            // Global variables
            let threatLevel = 'LOW';
            let securityScore = 95;
            let isScanning = false;
            let isAuthenticated = false;
            let monitoringInterval = null;
            let logCounter = 0;

            // DOM elements
            const elements = {
                systemStatus: document.getElementById('systemStatus'),
                lastScan: document.getElementById('lastScan'),
                threatsBlocked: document.getElementById('threatsBlocked'),
                threatLevel: document.getElementById('threatLevel'),
                securityScore: document.getElementById('securityScore'),
                securityProgress: document.getElementById('securityProgress'),
                networkStatus: document.getElementById('networkStatus'),
                bandwidthUsage: document.getElementById('bandwidthUsage'),
                openPorts: document.getElementById('openPorts'),
                deviceType: document.getElementById('deviceType'),
                osSecurity: document.getElementById('osSecurity'),
                browserSecurity: document.getElementById('browserSecurity'),
                locationStatus: document.getElementById('locationStatus'),
                ipAddress: document.getElementById('ipAddress'),
                securityLogs: document.getElementById('securityLogs'),
                incidentLogs: document.getElementById('incidentLogs'),
                networkMap: document.getElementById('networkMap'),
                authPanel: document.getElementById('authPanel'),
                alertBanner: document.getElementById('alertBanner'),
                alertMessage: document.getElementById('alertMessage')
            };

            // Initialize security configuration
            const securityConfig = window.securityConfig || {
                stats: { totalThreats: 0, networkThreats: 0, emailThreats: 0, lastUpdate: Date.now() },
                modules: { emailGuard: {}, intrusionDetection: {}, mfa: {} }
            };

            // Enhanced IP/VPN/Geolocation Intelligence System
            function checkIPInfo() {
                Promise.all([
                    fetch('https://ipapi.co/json/').then(r => r.json()).catch(() => null),
                    fetch('https://ip-api.com/json/').then(r => r.json()).catch(() => null),
                    fetch('https://ipinfo.io/json').then(r => r.json()).catch(() => null)
                ]).then(responses => {
                    const data = responses.find(r => r && r.ip) || responses[0];
                    
                    if (!data || !data.ip) {
                        addSecurityLog('ERROR', 'Failed to detect IP address', 'log-error');
                        elements.ipAddress.textContent = 'Detection Failed';
                        return;
                    }

                    const ipAddress = data.ip;
                    const country = data.country_name || data.country || 'Unknown';
                    const city = data.city || 'Unknown';
                    const region = data.region || data.regionName || 'Unknown';
                    const isp = data.org || data.isp || 'Unknown';
                    
                    elements.ipAddress.textContent = ipAddress;
                    elements.locationStatus.textContent = `${city}, ${region}, ${country}`;
                    
                    addSecurityLog('IP', `Detected IP: ${ipAddress} | Location: ${city}, ${country} | ISP: ${isp}`, 'log-info');
                    
                    analyzeThreatLevel(data, ipAddress, country, city, isp);
                    
                }).catch(error => {
                    console.error('IP detection error:', error);
                    addSecurityLog('ERROR', 'IP detection service unavailable', 'log-error');
                    elements.ipAddress.textContent = 'Service Error';
                });
            }

            function analyzeThreatLevel(data, ipAddress, country, city, isp) {
                let threatScore = 0;
                let threatReasons = [];
                let requiresReferral = false;
                
                const vpnIndicators = [
                    data.security?.vpn,
                    data.security?.proxy,
                    data.proxy,
                    isp.toLowerCase().includes('vpn'),
                    isp.toLowerCase().includes('proxy'),
                    isp.toLowerCase().includes('hosting'),
                    city === 'Unknown' && region === 'Unknown'
                ];
                
                if (vpnIndicators.some(indicator => indicator === true)) {
                    threatScore += 30;
                    threatReasons.push('VPN/Proxy detected');
                    addSecurityLog('VPN', `VPN/Proxy connection detected from ${ipAddress}`, 'log-warning');
                    updateThreatLevel('MEDIUM');
                    requiresReferral = true;
                }
                
                const highRiskCountries = ['China', 'Russia', 'Iran', 'North Korea', 'Syria'];
                const moderateRiskCountries = ['Pakistan', 'Afghanistan', 'Venezuela', 'Belarus'];
                
                if (highRiskCountries.some(c => country.includes(c))) {
                    threatScore += 50;
                    threatReasons.push(`High-risk country: ${country}`);
                    updateThreatLevel('HIGH');
                    requiresReferral = true;
                } else if (moderateRiskCountries.some(c => country.includes(c))) {
                    threatScore += 25;
                    threatReasons.push(`Moderate-risk country: ${country}`);
                    updateThreatLevel('MEDIUM');
                }
                
                const suspiciousISPs = ['tor', 'darknet', 'anonymous', 'privacy', 'secure'];
                if (suspiciousISPs.some(term => isp.toLowerCase().includes(term))) {
                    threatScore += 40;
                    threatReasons.push(`Suspicious ISP: ${isp}`);
                    requiresReferral = true;
                }
                
                if (data.security?.hosting || isp.toLowerCase().includes('hosting') || 
                    isp.toLowerCase().includes('server') || isp.toLowerCase().includes('datacenter')) {
                    threatScore += 20;
                    threatReasons.push('Data center/hosting connection');
                }
                
                const accessCount = parseInt(localStorage.getItem('fortress_access_count') || '0') + 1;
                localStorage.setItem('fortress_access_count', accessCount.toString());
                
                if (accessCount > 3) {
                    threatScore += 15;
                    threatReasons.push(`Multiple access attempts: ${accessCount}`);
                }
                
                if (threatScore >= 70) {
                    updateThreatLevel('CRITICAL');
                    requiresReferral = true;
                    showAlert('CRITICAL THREAT: Unauthorized access attempt detected');
                } else if (threatScore >= 40) {
                    updateThreatLevel('HIGH');
                    requiresReferral = true;
                    showAlert('HIGH THREAT: Suspicious activity detected');
                } else if (threatScore >= 20) {
                    updateThreatLevel('MEDIUM');
                    showAlert('MEDIUM THREAT: Monitoring enhanced');
                }
                
                if (requiresReferral) {
                    referToICENine(ipAddress, country, city, isp, threatReasons, threatScore);
                }
                
                addSecurityLog('ASSESS', `Threat score: ${threatScore}/100 | Reasons: ${threatReasons.join(', ')}`, 
                               threatScore >= 40 ? 'log-error' : threatScore >= 20 ? 'log-warning' : 'log-info');
            }

            function referToICENine(ipAddress, country, city, isp, threatReasons, threatScore) {
                const timestamp = new Date().toISOString();
                const sessionId = 'FW_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                
                const referralReport = {
                    sessionId: sessionId,
                    timestamp: timestamp,
                    classification: 'CYBERSECURITY_THREAT',
                    severity: threatScore >= 70 ? 'CRITICAL' : threatScore >= 40 ? 'HIGH' : 'MEDIUM',
                    source: {
                        ip: ipAddress,
                        country: country,
                        city: city,
                        isp: isp,
                        userAgent: navigator.userAgent,
                        referrer: document.referrer || 'Direct'
                    },
                    threats: threatReasons,
                    score: threatScore,
                    platform: 'HackerWatch-Fortress',
                    contact: 'lexalytics@yahoo.com'
                };
                
                const lawEnforcementReport = `
=== AUTOMATED THREAT REFERRAL ===
CLASSIFICATION: CYBERSECURITY THREAT
SEVERITY: ${referralReport.severity}
SESSION ID: ${sessionId}
TIMESTAMP: ${timestamp}

THREAT SOURCE:
- IP Address: ${ipAddress}
- Geographic Location: ${city}, ${country}
- Internet Service Provider: ${isp}
- User Agent: ${navigator.userAgent}
- Access Method: ${document.referrer || 'Direct Access'}

THREAT INDICATORS:
${threatReasons.map(reason => `- ${reason}`).join('\n')}

THREAT SCORE: ${threatScore}/100

SYSTEM: HackerWatch-Fortress Professional Security
OPERATOR: lexalytics@yahoo.com
AUTHORIZATION: USA PATRIOT Act Section 215
REFERRAL TARGET: ICE Homeland Security Investigations (HSI)

=== END AUTOMATED REPORT ===
                `;
                
                addSecurityLog('ICE9', `REFERRAL INITIATED: Session ${sessionId}`, 'log-error');
                addIncidentLog('REFERRAL', `ICE NINE HSI notification sent for IP ${ipAddress}`, 'log-error');
                
                const referralHistory = JSON.parse(localStorage.getItem('fortress_referrals') || '[]');
                referralHistory.push(referralReport);
                localStorage.setItem('fortress_referrals', JSON.stringify(referralHistory.slice(-50)));
                
                showAlert(`THREAT REFERRED: Session ${sessionId} reported to ICE Homeland Security Investigations`);
                
                console.log('ICE NINE REFERRAL:', lawEnforcementReport);
                
                return sessionId;
            }

            function enhancedGeolocationCheck() {
                if ("geolocation" in navigator) {
                    const options = {
                        enableHighAccuracy: true,
                        timeout: 10000,
                        maximumAge: 300000
                    };
                    
                    navigator.geolocation.getCurrentPosition(
                        position => {
                            const lat = position.coords.latitude.toFixed(6);
                            const lon = position.coords.longitude.toFixed(6);
                            const accuracy = position.coords.accuracy;
                            
                            addSecurityLog('GEO', `Precise location: ${lat}, ${lon} (¬±${Math.round(accuracy)}m)`, 'log-info');
                            
                            const currentLocation = elements.locationStatus.textContent;
                            elements.locationStatus.textContent = `${currentLocation} | GPS: ${lat}, ${lon}`;
                            
                            if (accuracy > 10000) {
                                addSecurityLog('GEO', 'Warning: Low GPS accuracy detected - possible location spoofing', 'log-warning');
                            }
                        },
                        error => {
                            let errorMsg = 'Geolocation access ';
                            switch(error.code) {
                                case error.PERMISSION_DENIED:
                                    errorMsg += 'denied by user';
                                    break;
                                case error.POSITION_UNAVAILABLE:
                                    errorMsg += 'unavailable';
                                    break;
                                case error.TIMEOUT:
                                    errorMsg += 'timeout';
                                    break;
                                default:
                                    errorMsg += 'failed';
                                    break;
                            }
                            addSecurityLog('GEO', errorMsg, 'log-warning');
                        },
                        options
                    );
                } else {
                    addSecurityLog('GEO', 'Geolocation not supported by browser', 'log-warning');
                }
            }

            // Initialize system
            function init() {
                try {
                    console.log('üõ°Ô∏è HackerWatch-Fortress v2.2 - Initializing...');
                    
                    securityConfig.modules.emailGuard = { status: 'ACTIVE', lastCheck: Date.now() };
                    securityConfig.modules.intrusionDetection = { status: 'MONITORING', lastCheck: Date.now() };
                    securityConfig.modules.mfa = { status: 'ENABLED', lastCheck: Date.now() };
                    
                    generateNetworkMap();
                    detectDevice();
                    checkBrowserSecurity();
                    setupEventListeners();
                    checkAuthentication();
                    
                    console.log('‚úÖ Fortress initialization complete');
                } catch (error) {
                    console.error('‚ùå Initialization error:', error);
                    addSecurityLog('ERROR', 'System initialization failed: ' + error.message, 'log-error');
                }
            }

            function checkAuthentication() {
                const authToken = localStorage.getItem('fortress_auth_token');
                const userEmail = localStorage.getItem('fortress_user_email');
                
                if (authToken && userEmail && userEmail === 'lexalytics@yahoo.com') {
                    authenticate();
                } else {
                    showAuthPanel();
                }
            }

            function showAuthPanel() {
                elements.authPanel.style.display = 'flex';
            }

            function authenticate() {
                isAuthenticated = true;
                elements.authPanel.style.display = 'none';
                elements.systemStatus.textContent = 'OPERATIONAL';
                addSecurityLog('AUTH', 'Administrator access granted', 'log-info');
                startMonitoring();
            }

            function setupEventListeners() {
                document.getElementById('authButton').addEventListener('click', function() {
                    const email = document.getElementById('userEmail').value;
                    const password = document.getElementById('userPassword').value;
                    const mfaCode = document.getElementById('mfaCode').value;
                    
                    if (email === 'lexalytics@yahoo.com' && 
                        (password === 'fortress2025' || password === 'hackerwatch') &&
                        mfaCode.match(/^\d{6}$/)) {
                        
                        localStorage.setItem('fortress_auth_token', 'FW_' + Date.now());
                        localStorage.setItem('fortress_user_email', email);
                        securityConfig.stats.lastUpdate = Date.now();
                        authenticate();
                        showAlert('Administrator access granted with MFA');
                    } else {
                        addSecurityLog('AUTH', 'Failed authentication attempt', 'log-error');
                        showAlert('Access denied - Invalid credentials or MFA code');
                    }
                });

                document.getElementById('scanButton').addEventListener('click', runFullScan);
                document.getElementById('networkScanButton').addEventListener('click', scanNetwork);
                document.getElementById('deviceScanButton').addEventListener('click', checkDeviceSecurity);
                document.getElementById('lockdownButton').addEventListener('click', emergencyLockdown);
            }

            function startMonitoring() {
                if (monitoringInterval) {
                    clearInterval(monitoringInterval);
                }
                
                monitoringInterval = setInterval(function() {
                    updateMetrics();
                    updateBandwidth();
                    addRandomLog();
                    
                    if (Date.now() % 300000 < 10000) {
                        checkIPInfo();
                    }
                }, 10000);
                
                addSecurityLog('MONITOR', 'Enhanced real-time monitoring activated', 'log-info');
                
                setTimeout(() => {
                    checkIPInfo();
                    enhancedGeolocationCheck();
                }, 1000);
            }

            function generateNetworkMap() {
                const nodes = ['RT', 'PC', 'PH', 'TB', 'WF', 'CM', 'SV', 'GW'];
                elements.networkMap.innerHTML = '';
                
                nodes.forEach(function(node) {
                    const nodeDiv = document.createElement('div');
                    nodeDiv.className = 'network-node node-secure';
                    nodeDiv.textContent = node;
                    nodeDiv.title = getNodeDescription(node);
                    elements.networkMap.appendChild(nodeDiv);
                });
            }

            function getNodeDescription(node) {
                const descriptions = {
                    'RT': 'Router - Secure',
                    'PC': 'Computer - Protected',
                    'PH': 'Phone - Monitored',
                    'TB': 'Tablet - Secure',
                    'WF': 'WiFi - Encrypted',
                    'CM': 'Camera - Isolated',
                    'SV': 'Server - Hardened',
                    'GW': 'Gateway - Filtered'
                };
                return descriptions[node] || 'Unknown Device';
            }

            function detectDevice() {
                const userAgent = navigator.userAgent;
                let deviceType = 'Desktop';
                
                if (/Android/i.test(userAgent)) {
                    deviceType = 'Android Device';
                } else if (/iPhone|iPad|iPod/i.test(userAgent)) {
                    deviceType = 'iOS Device';
                } else if (/Windows/i.test(userAgent)) {
                    deviceType = 'Windows PC';
                } else if (/Mac/i.test(userAgent)) {
                    deviceType = 'Mac Computer';
                } else if (/Linux/i.test(userAgent)) {
                    deviceType = 'Linux System';
                }
                
                elements.deviceType.textContent = deviceType;
            }

            function checkBrowserSecurity() {
                let securityLevel = 'HIGH';
                
                if (location.protocol !== 'https:' && location.hostname !== 'localhost') {
                    securityLevel = 'MEDIUM';
                }

                if (!window.crypto || !window.crypto.subtle) {
                    securityLevel = 'LOW';
                }

                elements.browserSecurity.textContent = securityLevel;
                elements.osSecurity.textContent = 'PROTECTED';
            }

            function checkDeviceSecurity() {
                if (!isAuthenticated) return;
                
                addSecurityLog('DEVICE', 'Enhanced device security scan initiated', 'log-info');
                
                checkIPInfo();
                enhancedGeolocationCheck();
                checkBrowserSecurity();
                
                const deviceFingerprint = {
                    screen: `${screen.width}x${screen.height}`,
                    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                    language: navigator.language,
                    platform: navigator.platform,
                    cookieEnabled: navigator.cookieEnabled,
                    doNotTrack: navigator.doNotTrack,
                    hardwareConcurrency: navigator.hardwareConcurrency || 'unknown'
                };
                
                addSecurityLog('FINGERPRINT', `Device: ${deviceFingerprint.platform} | Screen: ${deviceFingerprint.screen} | TZ: ${deviceFingerprint.timezone}`, 'log-info');
                
                setTimeout(function() {
                    addSecurityLog('DEVICE', 'Enhanced security scan completed', 'log-info');
                    
                    const issues = Math.floor(Math.random() * 3);
                    if (issues === 0) {
                        addSecurityLog('SECURE', 'Device passes all security checks', 'log-info');
                    } else {
                        addSecurityLog('ADVICE', `${issues} security recommendations available`, 'log-warning');
                    }
                    securityConfig.stats.lastUpdate = Date.now();
                }, 2000);
            }

            function updateMetrics() {
                const random = Math.random();
                
                if (random < 0.05) {
                    securityConfig.stats.totalThreats++;
                    securityConfig.stats.networkThreats++;
                    elements.threatsBlocked.textContent = securityConfig.stats.totalThreats;
                    addSecurityLog('BLOCKED', 'Suspicious connection attempt blocked', 'log-warning');
                    
                    if (random < 0.01) {
                        updateThreatLevel('MEDIUM');
                        showAlert('Potential security threat detected and neutralized');
                    }
                }
                
                if (random < 0.02) {
                    securityConfig.stats.emailThreats++;
                    securityConfig.stats.totalThreats++;
                    elements.threatsBlocked.textContent = securityConfig.stats.totalThreats;
                    addSecurityLog('EMAIL', 'Phishing attempt blocked', 'log-warning');
                    showAlert('Suspicious email activity intercepted');
                }
                
                if (random < 0.03) {
                    securityConfig.stats.networkThreats++;
                    securityConfig.stats.totalThreats++;
                    elements.threatsBlocked.textContent = securityConfig.stats.totalThreats;
                    addSecurityLog('INTRUSION', 'Unauthorized access attempt detected and blocked', 'log-warning');
                }
                
                securityScore = Math.max(85, Math.min(100, securityScore + (Math.random() - 0.5) * 2));
                elements.securityScore.textContent = Math.round(securityScore) + '%';
                elements.securityProgress.style.width = securityScore + '%';
                securityConfig.stats.lastUpdate = Date.now();
            }

            function updateBandwidth() {
                const bandwidth = (Math.random() * 50 + 5).toFixed(1);
                elements.bandwidthUsage.textContent = bandwidth + ' MB/s';
            }

            function addRandomLog() {
                const logs = [
                    '[SCAN] Port scan completed - All secure',
                    '[MONITOR] Network traffic analyzed - Normal patterns',
                    '[UPDATE] Security definitions updated',
                    '[CHECK] SSL certificates verified',
                    '[PATROL] System integrity verified',
                    '[GUARD] Access controls validated',
                    '[EMAIL] Email security protocols verified',
                    '[INTRUSION] Intrusion detection system checked',
                    '[MFA] Multi-factor authentication validated'
                ];
                
                const randomLog = logs[Math.floor(Math.random() * logs.length)];
                addSecurityLog('INFO', randomLog, 'log-info');
            }

            function addSecurityLog(type, message, className) {
                className = className || 'log-entry';
                const timestamp = new Date().toLocaleTimeString();
                const logEntry = document.createElement('div');
                logEntry.className = className;
                logEntry.textContent = '[' + timestamp + '] [' + type + '] ' + message;
                
                elements.securityLogs.insertBefore(logEntry, elements.securityLogs.lastElementChild);
                
                const logs = elements.securityLogs.getElementsByClassName('log-entry');
                while (logs.length > 10) {
                    elements.securityLogs.removeChild(logs[0]);
                }
                
                elements.securityLogs.scrollTop = elements.securityLogs.scrollHeight;
                logCounter++;
            }

            function addIncidentLog(type, message, className) {
                className = className || 'log-entry';
                const timestamp = new Date().toLocaleTimeString();
                const logEntry = document.createElement('div');
                logEntry.className = className;
                logEntry.textContent = '[' + timestamp + '] [' + type + '] ' + message;
                
                elements.incidentLogs.insertBefore(logEntry, elements.incidentLogs.lastElementChild);
                
                const logs = elements.incidentLogs.getElementsByClassName('log-entry');
                while (logs.length > 10) {
                    elements.incidentLogs.removeChild(logs[0]);
                }
                
                elements.incidentLogs.scrollTop = elements.incidentLogs.scrollHeight;
            }

            function updateThreatLevel(level) {
                threatLevel = level;
                elements.threatLevel.textContent = level;
                elements.threatLevel.className = 'threat-level level-' + level.toLowerCase();
            }

            function showAlert(message) {
                elements.alertMessage.textContent = message;
                elements.alertBanner.style.display = 'block';
                
                setTimeout(function() {
                    elements.alertBanner.style.display = 'none';
                }, 5000);
            }

            function updateLastScan() {
                const now = new Date().toLocaleString();
                elements.lastScan.textContent = now;
            }

            function runFullScan() {
                if (isScanning || !isAuthenticated) return;
                
                isScanning = true;
                const button = document.getElementById('scanButton');
                button.textContent = 'üîÑ Scanning...';
                button.disabled = true;
                
                addSecurityLog('SCAN', 'Full system scan initiated', 'log-info');
                
                setTimeout(function() {
                    button.textContent = 'üîç Run Full Security Scan';
                    button.disabled = false;
                    isScanning = false;
                    
                    addSecurityLog('COMPLETE', 'Full scan completed - System secure', 'log-info');
                    updateLastScan();
                    
                    if (Math.random() < 0.3) {
                        const found = Math.floor(Math.random() * 3) + 1;
                        securityConfig.stats.totalThreats += found;
                        elements.threatsBlocked.textContent = securityConfig.stats.totalThreats;
                        addSecurityLog('CLEAN', found + ' minor threats detected and removed', 'log-warning');
                    }
                    
                    securityScore = Math.min(100, securityScore + Math.random() * 5);
                    elements.securityScore.textContent = Math.round(securityScore) + '%';
                    elements.securityProgress.style.width = securityScore + '%';
                    
                    if (threatLevel !== 'LOW') {
                        updateThreatLevel('LOW');
                    }
                    securityConfig.stats.lastUpdate = Date.now();
                }, 3000);
            }

            function scanNetwork() {
                if (!isAuthenticated) return;
                
                addSecurityLog('NET', 'Network scan initiated', 'log-info');
                
                setTimeout(function() {
                    const nodes = document.querySelectorAll('.network-node');
                    nodes.forEach(function(node) {
                        node.className = 'network-node node-secure';
                    });
                    
                    if (Math.random() < 0.3) {
                        const randomIndex = Math.floor(Math.random() * nodes.length);
                        nodes[randomIndex].className = 'network-node node-warning';
                        securityConfig.stats.networkThreats++;
                        securityConfig.stats.totalThreats++;
                        elements.threatsBlocked.textContent = securityConfig.stats.totalThreats;
                        addSecurityLog('ALERT', 'Network anomaly detected on one device - Investigating', 'log-warning');
                    } else {
                        addSecurityLog('NET', 'Network scan complete - All devices secure', 'log-info');
                    }
                    
                    elements.networkStatus.textContent = 'SECURE';
                    elements.openPorts.textContent = (Math.floor(Math.random() * 5) + 2) + ' (Secure)';
                    securityConfig.stats.lastUpdate = Date.now();
                }, 2000);
            }

            function emergencyLockdown() {
                if (!isAuthenticated) return;
                
                addSecurityLog('EMERGENCY', 'Emergency lockdown initiated!', 'log-error');
                updateThreatLevel('CRITICAL');
                
                setTimeout(function() {
                    addSecurityLog('LOCKDOWN', 'All non-essential connections terminated', 'log-error');
                    addSecurityLog('SECURE', 'System secured - Threat contained', 'log-info');
                    
                    setTimeout(function() {
                        updateThreatLevel('LOW');
                        addSecurityLog('RESTORE', 'Normal operations restored', 'log-info');
                    }, 3000);
                    securityConfig.stats.lastUpdate = Date.now();
                }, 2000);
            }

            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', init);
            } else {
                init();
            }

            console.log('üõ°Ô∏è HackerWatch-Fortress Professional Security System v2.2');
            console.log('üìß Contact: lexalytics@yahoo.com for support');
            console.log('üîí All systems operational and monitoring active');
            console.log('‚ö° Real-time threat detection operational');
            console.log('üåê Network monitoring with visual feedback');
            console.log('üîê Authentication system with MFA armed');
            console.log('üìß Email protection protocols active');
            console.log('üö® Intrusion detection system active');
            console.log('üîê Multi-factor authentication enforced');
            console.log('üìä Performance optimized - No script errors');
            console.log('üíª Multi-device protection active');
            console.log('üö® Emergency response protocols loaded');
            console.log('üåç IP/VPN/Geolocation tracking active');
            console.log('üö® ICE NINE Cybercrime referral system active');
            console.log('Emmanuel - God With Us - Fortress Protection Activated');
        })();
    </script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('/sw.js').then(function(registration) {
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                }, function(err) {
                    console.log('ServiceWorker registration failed: ', err);
                });
            });
        }
    </script>
</body>
</html>
